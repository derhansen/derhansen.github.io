---
layout: post
title: Asynchronous banner management for TYPO3
date: '2013-04-23T17:04:00.001+02:00'
author: Torben Hansen
tags:
- fluid
- Extbase
- TYPO3
- Banner Management
modified_time: '2013-04-23T17:04:35.321+02:00'
blogger_id: tag:blogger.com,1999:blog-6517038209122183182.post-7300009293695896253
blogger_orig_url: http://www.derhansen.de/2013/04/asynchronous-banner-management-for-typo3.html
permalink: /2013/04/asynchronous-banner-management-for-typo3.html
---

Today I published my banner management extension <b>sf_banners</b> for TYPO3. It is able to show <b>image</b>, <b>flash</b> and <b>HTML </b>banners on a TYPO3 website. Each banner contains a <b>statistic </b>which shows the banners' <b>impressions </b>and <b>clicks</b>. The banners can be limited to an <b>maximum amount</b> of <b>clicks/impressions</b> and you can control the date on which the banners are shown by using the TYPO3 start- and stop function.<br /><br /><br />One of the main features of the extension is the ability to <b>load banners asynchronously</b>, so the main load time af a page is not being affected by the plugins rendering process.<br /><div><br /></div><br />The extension has been developed using <b>Extbase </b>and <b>Fluid </b>to ensure compatibility to existing and future TYPO3 versions. Also test driven development was one of the main aspects in the development process to ensure, that new features and code changes do not break existing functionality. The extension has been tested with all current versions of TYPO3 from 4.5.x to 6.0.x<br /><br />If you have any comments or suggestions, feel free to post them on the extensions GitHub&nbsp;<a href="https://github.com/derhansen/sf_banners" target="_blank">projectpage</a>.<br /><br /><h3>Development process</h3>Below follows a short summary about the development process of the extension.<br /><br />The first approach of the extension was to use pure Extbase/Fluid functionality to display the banners on a page. Since the extension has to update impressions and also has to select the banners from the repository on each request, the plugin has to be <b>non-cached</b>. After having finished this approach, I was disappointed by the performance of the page rendering time. As I tested the extension on several TYPO3 versions, I also found out, that the page rendering time <b>decreased </b>the higher the TYPO3 version got.<br /><br />So I read a lot of discussions on the TYPO3 mailinglists and the internet about Extbase and performance tuning and ended up with the solution to load all banners <b>asynchronously by Ajax</b>. To do so, I implemented JQuery and added an action to the controller which delivered the banners content as pure HTML. After that, everything seemed to run fine. Since the plugin now was cached and content fetched by Ajax, the page load time was'nt mainly affected by the extension. Sadly my integration tests showed, that there were problems with HTML/JS banners containing <b>document.write</b> JavaScript code. As the banners HTML/JS code was loaded asynchronously, a document.write statement would be executed <i>after the page DOM is loaded</i>. The result was, that the main page was loaded and shortly after that, the HTML/JS banner was shown and the formerly rendered page output was completely removed.<br /><br />The solution to get rid of the document.write problem was <a href="https://github.com/krux/postscribe" target="_blank">postscribe</a>. This standalone JS library <b>overrides document.write</b> and enables the usage of document.write after the DOM is ready.<br /><br />All development steps are filed on GitHub and you can look at each of the approaches described above, as the different steps have been <a href="https://github.com/derhansen/sf_banners/tags" target="_blank">tagged</a>.<br /><br /><br />