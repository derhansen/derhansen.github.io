---
layout: post
title: TYPO3 Extbase - mapping existing fields from fe_users
date: '2012-12-21T15:48:00.000+01:00'
author: Torben Hansen
tags:
- Tx_Extbase_Domain_Model_FrontendUser
- TYPO3 CMS
- fe_users
- Extbase
modified_time: '2012-12-21T15:48:24.359+01:00'
blogger_id: tag:blogger.com,1999:blog-6517038209122183182.post-5635215766333077315
blogger_orig_url: http://www.derhansen.de/2012/12/typo3-extbase-mapping-existing-fields.html
permalink: /2012/12/typo3-extbase-mapping-existing-fields.html
---

Extbase comes with an own domain model and repository to access the <b>frontend users</b> (fe_users) and <b>frontend groups</b> (fe_groups) tables.&nbsp;If you install <b>sr_feuser_register</b>, several extra fields are added to the fe_users table. Those extra fields are not included in extbase default domain model for fe_users, so you have to extend the domain model with the fields you want to access. This article show howto <b>extend the existing domain model</b> and some things to keep in mind.<br /><br /><b>Preperation</b><br /><br />The first thing to do is to create a <b>new domain model</b>, which extends the existing one. Create a new class for this in your extensions Domain\Model folder.<br /><pre><code><br />class Tx_Testext1_Domain_Model_FrontendUser extends Tx_Extbase_Domain_Model_FrontendUser {<br /><br />}<br /></code></pre><br />Next you need to <b>create a repository</b> for the new domain model. Create this in the Domain\Repository folder of your extension.<br /><pre><code><br />class Tx_Testext1_Domain_Repository_FrontendUserRepository extends Tx_Extbase_Domain_Repository_FrontendUserRepository {<br /><br />}<br /></code></pre><br />The next thing to do is to setup the <b>mapping</b> for the new table, so Extbase knows from which table it has to get the fields. Add the following to your sites typoscript setup.<br /><pre><code><br />config.tx_extbase.persistence.classes {<br />    Tx_Testext1_Domain_Model_FrontendUser {<br />        mapping {<br />            tableName = fe_users<br />        }<br />    }<br />}<br /></code></pre><br />You also need to configure, in which storage pid the frontend users are stored. You can set this in the typoscript constants of your extension.<br /><pre><code><br />plugin.tx_testext1 { <br />  persistence.storagePid = 100<br />}<br /></code></pre><br /><b>Extending&nbsp;the existing domain model</b><br />Now you're ready to extend the domain model&nbsp;Tx_Extbase_Domain_Model_FrontendUser to access the fields, which are not included in the default domain model. Actually you can also extend the domain model with new fields, but this is not part of this article.<br /><br />Lets assume, you want to access the field "comments", which was created by sr_feuser_register. The only thing to do is to add a <b>getter</b> and a <b>setter</b> for this field in the newly created domain model.<br /><pre><code><br />class Tx_Testext1_Domain_Model_FrontendUser extends Tx_Extbase_Domain_Model_FrontendUser {<br /><br /> /**<br />  * Comment<br />  *<br />  * @var string<br />  */<br /> protected $comment;<br /><br /> /**<br />  * Setter for comment<br />  *<br />  * @param string $comment<br />  * @return void<br />  */<br /> public function setComment ($comment) {<br />  $this-&gt;comment = $comment;<br /> }<br /><br /> /**<br />  * Getter for comment<br />  *<br />  * @return string<br />  */<br /> public function getComment () {<br />  return $this-&gt;comment;<br /> }<br />}<br /></code></pre><br />Now you can inject the newly created repository to get a record from the database.<br /><pre><code><br />/**<br /> * @var Tx_Testext1_Domain_Repository_FrontendUserRepository<br /> */<br />protected $userRepository;<br /><br />/**<br /> * Inject the user repository<br /> *<br /> * @param Tx_Testext1_Domain_Repository_FrontendUserRepository $userRepository<br /> * @return void<br /> */<br />public function injectFrontendUserRepository (Tx_Testext1_Domain_Repository_FrontendUserRepository $userRepository) {<br /> $this-&gt;userRepository = $userRepository;<br />}<br /><br />/**<br /> * Test action<br /> *<br /> * @return void<br /> */<br />public function testAction () {<br /> $user = $this-&gt;userRepository-&gt;findByUid(1);<br /> t3lib_utility_Debug::debug($user);<br />}<br /></code></pre><br />When you call the action showed above, you should see the debug output of the user object from the user with the uid 1. In the debug output, you should see the additional field "comment", which is included in the newly created domain model.<br /><br /><b>Fields with underscore and mixed case</b><br />The extension sr_feuser_register adds some additional field to fe_users, which include underscores. The same does "felogin", which actually adds fields with underscores and mixed case (e.g. "felogin_forgotHash").<br /><br />If you want to include fields with underscore in your domain model (e.g. "date_of_birth"), make sure to remove the underscore and to set a Uppercase of the next letter instead.<br /><pre><code><br />/**<br /> * Date of birth<br /> *<br /> * @var int<br /> */<br />protected $dateOfBirth;<br /><br />/**<br /> * Setter for date_of_birth<br /> *<br /> * @param int $dateOfBirth<br /> * @return void<br /> */<br />public function setDateOfBirth ($dateOfBirth) {<br /> $this-&gt;dateOfBirth = $dateOfBirth;<br />}<br /><br />/**<br /> * Getter for date_of_birth<br /> *<br /> * @return int<br /> */<br />public function getDateOfBirth () {<br /> return $this-&gt;dateOfBirth;<br />}<br /></code></pre><br />If you have fields with underscore and mixed case, just remove the underscore. Extbase seems to ignore the case.<br /><br />Here is an example of the field "felogin_forgotHash"<br /><pre><code><br />/**<br /> * Password forgot hash<br /> *<br /> * @var string<br /> */<br />protected $feloginForgothash;<br /></code></pre><br /><br /><br />