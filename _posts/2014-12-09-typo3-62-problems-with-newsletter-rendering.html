---
layout: post
title: TYPO3 6.2 - Still some problems with newsletter image rendering
date: '2014-12-09T19:44:00.001+01:00'
author: Torben Hansen
tags:
- Newsletter
- Direct Mail
- Direct Mail Subscription
- TYPO3 6.2
modified_time: '2015-01-01T19:51:59.386+01:00'
thumbnail: http://2.bp.blogspot.com/-04l48_xJwj8/VIbbo9TVqSI/AAAAAAAANv4/ax9Knnii4i4/s72-c/activateContentAdapter.png
blogger_id: tag:blogger.com,1999:blog-6517038209122183182.post-8820177879357927650
blogger_orig_url: http://www.derhansen.de/2014/12/typo3-62-problems-with-newsletter-rendering.html
permalink: /2014/12/typo3-62-problems-with-newsletter-rendering.html
---

I've done a lot of TYPO3 4.5 to TYPO3 6.2 migrations the last weeks and struggled with some strange behaviour of TYPO3 6.2 in combination with <b>newsletter pages</b> and the TYPO3 Extensions <b>direct_mail </b>and <b>direct_mail_subscription</b>.<br /><br />I'm pretty sure, some people might run into the same problems during the usage of TYPO3 6.2 and direct_mail / direct_mail_subscription, so I'll describe how I solved the most common problems in this article.<br /><br /><u>Update 01.01.2015</u><br /><br />The first two problems are <a href="https://github.com/TYPO3/TYPO3.CMS/commit/bce5ae7b988ec2fb658b49a93db946b1ed6e4fd2" target="_blank">solved</a> now and you can use renderMethod = table in TYPO3 6.2 and 7.x directly with css_styled_content.<br /><br /><h3><b>Newsletter pages not rendering images</b></h3><br />In order to display HTML newsletters in various e-mail clients it is recommended to output the page layout in old-school <b>HTML table design</b>. In order to do so, I use the following TypoScript for images.<br /><br /><pre><code><br />tt_content.image.20.renderMethod = table<br /></code></pre><br />This renders image-output in table design and enables the editor to set alignments for images in newsletters. In TYPO3 6.0 and 6.1 I had some major problems with using css_styled_content with the renderMethod shown above, so I used to include the css_styled_content configuration for TYPO3 v4.7 as described in my former <a href="http://www.derhansen.de/2013/07/direct-mail-with-images-as-table-output.html" target="_blank">blogpost</a>.<br /><br />This all worked fine for TYPO3 sites migrated from 6.x to TYPO3 6.2. With TYPO3 sites, <b>created directly with TYPO3 6.2</b>, this did'nt work any more and images were just not rendered. I spent several hours of debugging to find out, that a setting in the LocalConfiguration.php was the cause for this. Sites, that have been migrated from TYPO3 6.x to TYPO3 6.2 had&nbsp;<b>[FE][activateContentAdapter]</b> enabled in the Install tool.<br /><br />After I enabled the&nbsp;[FE][activateContentAdapter] for the directly created TYPO3 6.2 sites, images were rendered correctly with the css_styled_content (v4.7) configuration.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-04l48_xJwj8/VIbbo9TVqSI/AAAAAAAANv4/ax9Knnii4i4/s1600/activateContentAdapter.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-04l48_xJwj8/VIbbo9TVqSI/AAAAAAAANv4/ax9Knnii4i4/s1600/activateContentAdapter.png" height="80" width="400" /></a></div><br />Anyway, the install tool shows a <b>warning</b>, that setting activateContentAdapter is slow, so this only seems to be a temporary solution.<br /><br />In my opinion a better solution would be to <b>use css_styled_content which comes with TYPO3 6.2</b> and deactivate [FE][activateContentAdapter], but at the time of writing, there is a bug (see problem below) preventing me from using that option.<br /><br /><h3><b>Image rendering buggy using TYPO3 6.2 css styled content and renderMethod = table</b></h3><br />When I tried to debug my former problem with images not being rendered in page output, I also tried to use css_styled_content from TYPO3 6.2 directly. This resulted in the images being rendered incorrectly (see screenshots below).<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-0ia-hq48IMU/VIc5ruHUbUI/AAAAAAAANwY/PjB4X_qHW4w/s1600/logos-backend.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-0ia-hq48IMU/VIc5ruHUbUI/AAAAAAAANwY/PjB4X_qHW4w/s1600/logos-backend.png" height="212" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">3 TYPO3 Logos in TYPO3 backend - each with an individial label in the image</td></tr></tbody></table><br /><div>The output using css_styled_content with renderMethod = table results in the following output.</div><div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-cI6gK2lKw5Y/VIc5riySwDI/AAAAAAAANwc/hmfXhAwtU3U/s1600/logos-frontend.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-cI6gK2lKw5Y/VIc5riySwDI/AAAAAAAANwc/hmfXhAwtU3U/s1600/logos-frontend.png" height="152" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Resulting image output shows 4 images and only the last image is rendered</td></tr></tbody></table><br /><br /><div class="separator" style="clear: both; text-align: center;"></div>This seems to be a problem in TYPO3 6.2 and there is also an issue on <a href="https://forge.typo3.org/issues/47004" target="_blank">Forge</a> for this one. I <strike>will try to create</strike>&nbsp;created a patch, so both the linked and related issues can be closed.<br /><br /><h3><b>Newsletter not sent to recipient</b></h3><b><br /></b>The last problem I spent some time with is, that newly subscribed recipients did not receive the sent newsletter. As I only send out HTML newsletters, I used to set the following TypoScript in the configuration for <b>direct_mail_subscription</b><br /><br /><pre><code><br />plugin.feadmin.dmailsubscription {<br />  create {<br />    overrideValues.module_sys_dmail_html = 1<br />  }<br />}<br /></code></pre><br />It seems, that this does not work with the latest versions of direct_mail_subscription, so newly created records in tt_address did not contain the nescecary flag. I tried several other approaches including setting hidden input fields for the field mod_sys_dmail_html to the registration form and setting TCAdefaults, but all approaches did'nt work. At least the issue is <a href="https://forge.typo3.org/issues/62589" target="_blank">known</a>, so a fix for this problem may be available soon.<br /><br />To work around this issue, I set the default value for the field mod_sys_dmail_html to 1 directly in the database by using the following SQL<br /><br /><pre><code><br />ALTER TABLE `tt_address` CHANGE `module_sys_dmail_html` `module_sys_dmail_html` tinyint(3) unsigned NOT NULL DEFAULT '1';<br /></code></pre><br />Make sure, that this setting may be reverted, if you use the database analyzer in the install tool and apply the original default value for the field.<br /><br /></div>